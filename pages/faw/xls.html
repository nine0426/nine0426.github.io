<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link href=".../img/title.png" rel="icon" type="image/x-ico">
  <link rel="stylesheet" href=".../css/other.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>
  <title>表格读取</title>
</head>

<body>
  <input type="file" id="input" />
  <table id="output"></table>
  <br>
  <h2><a href=".../index.html">返回主页</a></h2>
  <script>
    const input = document.getElementById('input');
    const output = document.getElementById('output');

    input.addEventListener('change', () => {
      const reader = new FileReader();
      reader.readAsArrayBuffer(input.files[0]);
      reader.onload = () => {
        const data = new Uint8Array(reader.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        let html = '';
        rows.forEach((row) => {
          html += '<tr>';
          row.forEach((cell) => {
            html += `<td>${cell}</td>`;
          });
          html += '</tr>';
        });
        output.innerHTML = html;
      };
    });

  </script>
</body>

</html>